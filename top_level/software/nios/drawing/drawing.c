/*
 * drawing.c
 *
 *  Created on: 17 gru 2017
 *      Author: caput
 */
#include "drawing.h"

static volatile uint8_t* const frame_buffer = (uint8_t*)VRAM_BASE;

static const uint8_t player_pbm[PLAYER_SIZE_Y * PLAYER_SIZE_X] =
{
		0b00000000,	0b00000011, 0b11000000, 0b00000000,
		0b00000000,	0b00000011, 0b11000000, 0b00000000,
		0b00000000,	0b00000111, 0b11100000, 0b00000000,
		0b00000000,	0b00000111, 0b11100000, 0b00000000,
		0b00000000,	0b00000111, 0b11100000, 0b00000000,
		0b00000000,	0b00000111, 0b11100000, 0b00000000,
		0b00000000,	0b00001111, 0b11110000, 0b00000000,
		0b00000000,	0b00001111, 0b11110000, 0b00000000,
		0b00000000,	0b01001111, 0b11110010, 0b00000000,
		0b00000000,	0b01011111, 0b11111010, 0b00000000,
		0b00000000,	0b01011111, 0b11111010, 0b00000000,
		0b00000000,	0b01011110, 0b01111010, 0b00000000,
		0b00000000,	0b01011110, 0b01111010, 0b00000000,
		0b00000000,	0b01111110, 0b01111110, 0b00000000,
		0b00000100,	0b01111100, 0b00111110, 0b00100000,
		0b00000100,	0b01111101, 0b10111110, 0b00100000,
		0b00000110,	0b01111001, 0b10011110, 0b01100000,
		0b00001110,	0b01111011, 0b11011110, 0b01110000,
		0b00001110,	0b01111111, 0b11111110, 0b01110000,
		0b00001110,	0b11111111, 0b11111111, 0b01110000,
		0b00001110,	0b11111111, 0b11111111, 0b01110000,
		0b00001110,	0b11111111, 0b11111111, 0b01110000,
		0b00001110,	0b11111111, 0b11111111, 0b01110000,
		0b00001111,	0b11111111, 0b11111111, 0b11110000,
		0b00001111,	0b11111111, 0b11111111, 0b11110000,
		0b00001111,	0b11111111, 0b11111111, 0b11110000,
		0b00001111,	0b11111101, 0b10111111, 0b11110000,
		0b00001111,	0b11111001, 0b10011111, 0b11110000,
		0b00011111,	0b11110001, 0b10001111, 0b11111000,
		0b00111111,	0b11100001, 0b10000111, 0b11111100,
		0b01111111,	0b11000001, 0b10000011, 0b11111110,
		0b11111111,	0b10000001, 0b10000001, 0b11111111
};

static const uint8_t shot_pbm[SHOT_SIZE_Y * SHOT_SIZE_X] =
{
		0b00000000, 0b00000000,
		0b00000000, 0b00000000,
		0b00000000, 0b00000000,
		0b00000000, 0b00000000,
		0b00000011, 0b11000000,
		0b00000111, 0b11100000,
		0b00001111, 0b11110000,
		0b00001111, 0b11110000,
		0b00001111, 0b11110000,
		0b00001111, 0b11110000,
		0b00000111, 0b11100000,
		0b00000011, 0b11000000,
		0b00000000, 0b00000000,
		0b00000000, 0b00000000,
		0b00000000, 0b00000000,
		0b00000000, 0b00000000
};

static const uint8_t alien1_pbm[ALIEN1_SIZE_Y * ALIEN1_SIZE_X] =
{
		0b00000000, 0b00001111, 0b11110000, 0b00000000,
		0b00000000, 0b01111111, 0b11111110, 0b00000000,
		0b00000000, 0b11111111, 0b11111111, 0b00000000,
		0b00000011, 0b11111111, 0b11111111, 0b11000000,
		0b00000111, 0b11111111, 0b11111111, 0b11100000,
		0b00001111, 0b11111111, 0b11111111, 0b11110000,
		0b00011111, 0b11111111, 0b11111111, 0b11111100,
		0b00111111, 0b11111100, 0b00111111, 0b11111110,
		0b11111111, 0b11111000, 0b00011111, 0b11111111,
		0b11111111, 0b11110000, 0b00001111, 0b11111111,
		0b11111111, 0b11110001, 0b10001111, 0b11111111,
		0b11111111, 0b11110000, 0b00001111, 0b11111111,
		0b11111111, 0b11111000, 0b00011111, 0b11111111,
		0b11111111, 0b11111100, 0b00111111, 0b11111111,
		0b00111111, 0b11111111, 0b11111111, 0b11111100,
		0b00011111, 0b11111111, 0b11111111, 0b11111000,
		0b00001111, 0b11111111, 0b11111111, 0b11110000,
		0b00000111, 0b11111111, 0b11111111, 0b11100000,
		0b00000011, 0b11111111, 0b11111111, 0b11000000,
		0b00000111, 0b11111111, 0b11111111, 0b11100000,
		0b00000111, 0b01111111, 0b11111110, 0b11100000,
		0b00001110, 0b00001111, 0b11110000, 0b01110000,
		0b00001110, 0b00000000, 0b00000000, 0b01110000,
		0b00011100, 0b00000000, 0b00000000, 0b00111000,
		0b00011100, 0b00000000, 0b00000000, 0b00111000,
		0b00111000, 0b00000000, 0b00000000, 0b00011100,
		0b00111000, 0b00000000, 0b00000000, 0b00011100,
		0b00111000, 0b00000000, 0b00000000, 0b00011100,
		0b00111000, 0b00011110, 0b01111000, 0b00011100,
		0b00011100, 0b00110000, 0b00001100, 0b00111000,
		0b00011110, 0b01000000, 0b00000010, 0b01111000,
		0b00001111, 0b10000000, 0b00000001, 0b11110000
};


void draw_player(uint16_t x, uint16_t y)
{
	if ((x > 0) && (x < MAX_X - PLAYER_SIZE_X) && (y > 0) && (y < MAX_Y - PLAYER_SIZE_Y))
	{
		for(uint8_t i = 0; i < PLAYER_SIZE_Y; i++)
		{
			for(uint8_t j = 0; j < PLAYER_SIZE_X; j++)
			{
				*((uint8_t*)VRAM_BASE + (y + i) * MAX_X + x + j) = player_pbm[i * PLAYER_SIZE_X + 3 - j];
			}
		}
	}
}

void draw_alien1(uint16_t x, uint16_t y)
{
	if ((x > 0) && (x < MAX_X - ALIEN1_SIZE_X) && (y > 0) && (y < MAX_Y - ALIEN1_SIZE_Y))
	{
		for(uint8_t i = 0; i < ALIEN1_SIZE_Y; i++)
		{
			for(uint8_t j = 0; j < ALIEN1_SIZE_X; j++)
			{
				*((uint8_t*)VRAM_BASE + (y + i) * MAX_X + x + j) = alien1_pbm[i * ALIEN1_SIZE_X + 3 - j];
			}
		}
	}
}

void draw_shot(uint16_t x, uint16_t y)
{
	if ((x > 0) && (x < MAX_X - SHOT_SIZE_X) && (y > 0) && (y < MAX_Y - SHOT_SIZE_Y))
	{
		for(uint8_t i = 0; i < SHOT_SIZE_Y; i++)
		{
			for(uint8_t j = 0; j < SHOT_SIZE_X; j++)
			{
				*((uint8_t*)VRAM_BASE + (y + i) * MAX_X + x + j) = shot_pbm[i * SHOT_SIZE_X + 1 - j];
			}
		}
	}
}

void erase_draw(uint16_t x, uint16_t y, uint8_t x_size, uint8_t y_size)
{
	if ((x > 0) && (x < MAX_X - x_size) && (y > 0) && (y < MAX_Y - y_size))
	{
		for(uint8_t i = 0; i < y_size; i++)
		{
			for(uint8_t j = 0; j < x_size; j++)
			{
				*((uint8_t*)VRAM_BASE + (y + i) * MAX_X + x + j) = 0x00;
			}
		}
	}
}
void clear_screen(void)
{
	for(uint32_t i = 0; i < VRAM_SIZE_VALUE; i++)
	{
		*((uint8_t*)VRAM_BASE + i) = 0x00;
	}
}
